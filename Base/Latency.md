**Задержка**. Это время, которое проходит с момента, когда запрос **отправлен**, до момента, когда система начинает **отвечать**. Время ожидания старта ответа. Измеряется в миллисекундах. Если пользователю важна **мгновенная реакция системы** → оптимизируй **latency** (чтобы интерфейс был отзывчивым).Для **интерактивности** → важна latency.

- **Виды latency**

	- **End-to-end (пользовательская):** время от клика/запроса до полной готовности результата на экране
    
	- **Сетевая:** RTT/коннект/TLS/TTFB.
    
	- **Серверная:** время обработки на бэке (без сети).
    
	- **Компонентная:** БД, кэш, RPC между сервисами.

- **Где используется**
	- В сетях — это время прохождения пакета от клиента до сервера и обратно (RTT — Round Trip Time).
	- В приложениях — это задержка до того, как начнётся фактическая обработка (например, время поиска нужного сервиса в микросервисной архитектуре, время постановки в очередь, время инициализации соединения и т.д.)

- **Высокая latency** 
	- Система может быть "ленивой" на старте (например, длинная очередь запросов или медленная сеть). Даже быстрая обработка внутри потом не спасает — пользователь уже ждёт.

- **Фокус на latency**
	- Важно в **реальном времени** и **интерактивных приложениях**: игры, звонки (VoIP), видеостриминг, торговые платформы (биржи).
	- Если высокая задержка — пользователь чувствует "лаг".
	- Оптимизация: снижение сетевой задержки (CDN, edge computing, gRPC), уменьшение количества хопов между сервисами.

- **Задержка зависит от** 
	- Накопитель
		- RAM 1мб  = 250 000 нс
		- SSD 1мб = 1 мс
		- HDD 1 мб = 20 мс

- **Как замерять latency**
	- **Клиент:** браузерные тайминги (Navigation/Resource/Long Tasks), RUM-агент.
    
	- **Edge/балансер:** NGINX/Envoy (access logs с $request_time / upstream_*).
    
	- **Сервис:** middleware, тайминги вокруг хендлеров и исходящих вызовов (DB, HTTP, gRPC).
    
	- **БД/кэш/очереди:** их метрики (slow queries, command latency).
    
	- **Трассировка:** сквозные спаны и «стёжки» между сервисами.

- **Инструменты**
	- **Браузер (RUM):** Performance API, `LargestContentfulPaint`, `navigation/paint/resource` тайминги.
    
	- **Сервер:** Prometheus + Histogram/Summary, OpenTelemetry (traces + metrics).
    
	- **Нагрузка:** `k6`, `wrk`, `vegeta`, JMeter.
    
	- **Сеть:** `curl -w`, `tcping`, `mtr`/`traceroute`.
    
	- **БД:** slow query logs, `pg_stat_statements`/`SHOW PROFILES` и т.п.

- [[Low-latency приложения]] нужно изначально писать с ориентацией на это, не получится просто разработать приложение, а потом оптимизировать его.


**Доп. ссылки:** [[Производительность системы]] 

**Tags**: #Backend  #IT  #АрхитектуаПриложения 