**Apache ZooKeeper** ‚Äî —ç—Ç–æ _—Å–µ—Ä–≤–∏—Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º_.  
–û–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

- —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏;
    
- —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –º–µ–∂–¥—É —É–∑–ª–∞–º–∏;
    
- –º–µ—Ö–∞–Ω–∏–∑–º –≤—ã–±–æ—Ä–æ–≤ –ª–∏–¥–µ—Ä–∞;
    
- —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏;
    
- —Å–µ—Ä–≤–∏—Å-–¥–∏—Å–∫–∞–≤–µ—Ä–∏.
    

–≠—Ç–æ –Ω–µ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–º –ø–æ–Ω–∏–º–∞–Ω–∏–∏. ZooKeeper —Ö—Ä–∞–Ω–∏—Ç –Ω–µ–±–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ, –Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∏—Ö **—Å—Ç—Ä–æ–≥—É—é —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å (consistency)** –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Å—Ä–µ–¥–µ.

---

# üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ZooKeeper

ZooKeeper-–∫–ª–∞—Å—Ç–µ—Ä –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **ensemble** (–∞–Ω—Å–∞–º–±–ª—å).

–û–±—ã—á–Ω–æ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑:

- **3‚Äì5 –Ω–æ–¥ (server)** ‚Äî –¥–ª—è –∫–≤–æ—Ä—É–º–∞
    
- –ö–ª–∏–µ–Ω—Ç–æ–≤, –ø–æ–¥–∫–ª—é—á–∞—é—â–∏—Ö—Å—è –ø–æ ZooKeeper-–ø—Ä–æ—Ç–æ–∫–æ–ª—É
    

### –†–æ–ª–∏ —É–∑–ª–æ–≤:

1. **Leader** ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø–∏—Å–∏ (write), –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
    
2. **Followers** ‚Äî –ø–æ–ª—É—á–∞—é—Ç –∑–∞–ø–∏—Å—å –æ—Ç –ª–∏–¥–µ—Ä–∞, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç –µ—ë.
    
3. **Observers (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)** ‚Äî —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞—é—Ç, –Ω–µ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–∏.
    

---

# üì¶ –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö ZNode

–î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –≤–∏–¥–µ –¥–µ—Ä–µ–≤–∞ (–ø–æ—Ö–æ–∂–µ –Ω–∞ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É):

`/ ‚îú‚îÄ‚îÄ app ‚îÇ   ‚îú‚îÄ‚îÄ config ‚îÇ   ‚îî‚îÄ‚îÄ state ‚îî‚îÄ‚îÄ services     ‚îú‚îÄ‚îÄ service1     ‚îî‚îÄ‚îÄ service2`

–ü—É—Ç—å `/app/config` ‚Äî —ç—Ç–æ **ZNode**.

–¢–∏–ø—ã ZNode:

- **Persistent** ‚Äî –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ
    
- **Ephemeral** ‚Äî –∏—Å—á–µ–∑–∞—é—Ç –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞
    
- **Sequential** ‚Äî —Å–æ–∑–¥–∞—é—Ç—Å—è —Å –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–æ–º
    

> –ë–ª–∞–≥–æ–¥–∞—Ä—è ephemeral-—Å—É—â–Ω–æ—Å—Ç—è–º ZooKeeper –ª–µ–≥–∫–æ –¥–µ–ª–∞—Ç—å leader election –∏ —Å–µ—Ä–≤–∏—Å-–¥–∏—Å–∫–∞–≤–µ—Ä–∏.

---

# üîê –ú–µ—Ö–∞–Ω–∏–∑–º —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ (ZAB)

ZooKeeper –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª **ZAB (ZooKeeper Atomic Broadcast)**:

- –õ–∏–¥–µ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
    
- –†–∞—Å—Å—ã–ª–∞–µ—Ç –Ω–∞ —Ñ–æ–ª–ª–æ–≤–µ—Ä–æ–≤
    
- –ü–æ–ª—É—á–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (–∫–≤–æ—Ä—É–º)
    
- –§–∏–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø–∏—Å—å
    

–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è:

- **Atomicity** ‚Äî –ª–∏–±–æ –≤—Å–µ –Ω–æ–¥—ã –ø—Ä–∏–Ω—è–ª–∏, –ª–∏–±–æ –Ω–∏–∫—Ç–æ
    
- **Sequential consistency** ‚Äî –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤ —Å—Ç—Ä–æ–≥–æ–º –ø–æ—Ä—è–¥–∫–µ
    
- **Durability** ‚Äî –¥–∞–Ω–Ω—ã–µ –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è (–ø–∏—à—É—Ç—Å—è –≤ –∂—É—Ä–Ω–∞–ª)
    

---

# ü™¢ Watchers ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º —Å–æ–±—ã—Ç–∏–π

–í—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ ZNode:

- –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
    
- —Å–æ–∑–¥–∞–Ω–∏–µ —É–∑–ª–∞
    
- —É–¥–∞–ª–µ–Ω–∏–µ
    
- –ø–æ—è–≤–ª–µ–Ω–∏–µ –¥–æ—á–µ—Ä–Ω–∏—Ö —É–∑–ª–æ–≤
    

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:

- —Å–µ—Ä–≤–∏—Å-–¥–∏—Å–∫–∞–≤–µ—Ä–∏
    
- –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    
- –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–∏
    

---

# üëë –í—ã–±–æ—Ä –ª–∏–¥–µ—Ä–∞ –≤ ZooKeeper

–û–¥–∏–Ω –∏–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ ‚Äî **leader election**.

–ü—Ä–∏–º–µ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–∞:

1. –ö–ª–∏–µ–Ω—Ç—ã —Å–æ–∑–¥–∞—é—Ç ephemeral-sequential —É–∑–µ–ª `/election/node_00000001`
    
2. –ö–ª–∏–µ–Ω—Ç —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –Ω–æ–º–µ—Ä–æ–º —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ª–∏–¥–µ—Ä–æ–º
    
3. –ü—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –ª–∏–¥–µ—Ä–∞ –µ–≥–æ ephemeral-—É–∑–µ–ª –∏—Å—á–µ–∑–∞–µ—Ç
    
4. –õ–∏–¥–µ—Ä–æ–º —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–π
    

–≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π **failover**.

---

# üîí Distributed Locks

ZooKeeper —É–Ω–∏–≤–µ—Ä—Å–∞–ª–µ–Ω –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫:

1. –°–æ–∑–¥–∞—ë—Ç—Å—è —É–∑–µ–ª `lock/lock-`
    
2. –ö–ª–∏–µ–Ω—Ç—ã –∂–¥—É—Ç —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å –ø–æ sequential ID
    
3. –ü–æ–ª—É—á–∏–≤ –ª–æ–∫ ‚Äî –≤—ã–ø–æ–ª–Ω—è—é—Ç –æ–ø–µ—Ä–∞—Ü–∏—é
    
4. –£–¥–∞–ª—è—é—Ç ZNode ‚Äî –ª–æ–∫ –æ—Å–≤–æ–±–æ–∂–¥—ë–Ω
    

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:

- —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–µ–∫—Ü–∏–π
    
- —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
    

---

# üìå –ì–¥–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è ZooKeeper

### 1. **Apache Kafka (–¥–æ –≤–µ—Ä—Å–∏–∏ 2.8)**

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–ª—è:

- —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –æ –±—Ä–æ–∫–µ—Ä–∞—Ö
    
- –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–æ–ø–∏–∫–æ–≤
    
- –≤—ã–±–æ—Ä–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
    

### 2. **Hadoop / HBase**

–î–ª—è:

- –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –º–∞—Å—Ç–µ—Ä–æ–≤
    
- —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
    

### 3. **–°–µ—Ä–≤–∏—Å-–¥–∏—Å–∫–∞–≤–µ—Ä–∏**

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ ephemeral ZNode.

### 4. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**

–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —Å—Ä–∞–∑—É —É–≤–µ–¥–æ–º–∏—Ç—å –≤—Å–µ —É–∑–ª—ã.

### 5. **–°–ª–æ–∂–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã**

–ë–ª–∞–≥–æ–¥–∞—Ä—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É –æ–ø–µ—Ä–∞—Ü–∏–π.

---

# üëç –ü–ª—é—Å—ã ZooKeeper

- –û—á–µ–Ω—å –Ω–∞–¥—ë–∂–Ω—ã–π –∏ battle-tested
    
- –í—ã—Å–æ–∫–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å
    
- –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç–∫–∞–∑–∞—Ö
    
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º watchers
    
- –ì–∏–±–∫–∞—è –º–æ–¥–µ–ª—å ZNode (—Ñ–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
    

---

# üëé –ú–∏–Ω—É—Å—ã ZooKeeper

- –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è, —á–µ–º etcd
    
- –°—Ç–∞—Ä—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –±–µ–∑ REST/gRPC
    
- –ù—É–∂–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Java –∏ –ø–∞–º—è—Ç–∏ (GC)
    
- –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ —Å–≤–æ–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ (–Ω–µ HTTP)
    
- –ë–æ–ª—å—à–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —á–∏—Ç–∞—é—â–∏–µ —É–∑–ª—ã —Ç—Ä–µ–±—É—é—Ç —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —á–∏—Å–ª–æ —Å–µ—Ä–≤–µ—Ä–æ–≤
    

---

# üÜö –ü–æ—á–µ–º—É —Å–µ–π—á–∞—Å –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç etcd

- etcd –ø—Ä–æ—â–µ, modern, REST/gRPC API
    
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Raft, –ø—Ä–æ—Å—Ç–æ–π –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π
    
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ Kubernetes
    
- –õ–µ–≥—á–µ –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏ (Go, –∞ –Ω–µ Java)
    

–ù–æ ZooKeeper –≤—Å—ë –µ—â—ë —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å—Ç–∞—Ä—ã—Ö –∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**:

**–ü—Ä–∏–º–µ—Ä**:

**–î–æ–ø. —Å—Å—ã–ª–∫–∏:** [[–•—Ä–∞–Ω–∏–ª–∏—â–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—ã]]

**Tags**: #IT #Backend  #–ë–∞–∑–∞–î–∞–Ω–Ω—ã—Ö 