**Bitmap-–∏–Ω–¥–µ–∫—Å** ‚Äî —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–±–∏—Ç–æ–≤—ã–µ –º–∞—Å—Å–∏–≤—ã (bitmaps)**, —á—Ç–æ–±—ã –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∏ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ª–æ–≤–∏–π.  
–≠—Ç–æ –∏–Ω–¥–µ–∫—Å, –∫–æ—Ç–æ—Ä—ã–π –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è **–∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–æ–ª–æ–Ω–Ω–æ—á–Ω—ã—Ö –ë–î –∏ –ø–æ–ª–µ–π —Å –Ω–µ–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π**.

–û–±—ä—è—Å–Ω—é –ø—Ä–æ—Å—Ç–æ üëá

---

# üß© –ß—Ç–æ —Ç–∞–∫–æ–µ Bitmap-–∏–Ω–¥–µ–∫—Å –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏

–ü—Ä–µ–¥—Å—Ç–∞–≤—å –∫–æ–ª–æ–Ω–∫—É `gender`:

|id|gender|
|---|---|
|1|M|
|2|F|
|3|M|
|4|M|
|5|F|

Bitmap-–∏–Ω–¥–µ–∫—Å —Å–æ–∑–¥–∞—ë—Ç **–ø–æ –æ–¥–Ω–æ–º—É –±–∏—Ç–æ–≤–æ–º—É –º–∞—Å—Å–∏–≤—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è**:

### –ë–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ –¥–ª—è "M":

`id: 1 2 3 4 5 bit:1 0 1 1 0`

### –ë–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞ –¥–ª—è "F":

`id: 1 2 3 4 5 bit:0 1 0 0 1`

–û–¥–∏–Ω –±–∏—Ç = –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ.

---

# üî• –ü–æ—á–µ–º—É —ç—Ç–æ –±—ã—Å—Ç—Ä–æ?

–ü–æ—Ç–æ–º—É —á—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –±–∏—Ç–∞–º–∏ ‚Äî **—Å—É–ø–µ—Ä –¥–µ—à—ë–≤—ã–µ** –Ω–∞ —É—Ä–æ–≤–Ω–µ CPU.

### –ù–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–ø—Ä–æ—Å:

`WHERE gender = 'M' AND age BETWEEN 30 AND 40;`

–ë–∞–∑–∞ —Å–æ–∑–¥–∞—ë—Ç bitmap –¥–ª—è `gender=M`  
–∏ bitmap –¥–ª—è `age 30‚Äì40`,  
–∏ –¥–µ–ª–∞–µ—Ç:

`bitmap_M   AND   bitmap_age`

–û–ø–µ—Ä–∞—Ü–∏—è AND –Ω–∞–¥ –±–∏—Ç–æ–≤—ã–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏ ‚Üí –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–∑–∞ –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥—ã**, –¥–∞–∂–µ –¥–ª—è –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Å—Ç—Ä–æ–∫.

---

# üß† –ì–¥–µ Bitmap-–∏–Ω–¥–µ–∫—Å—ã –∏–¥–µ–∞–ª—å–Ω—ã?

### ‚úî –ö–æ–ª–æ–Ω–∫–∏ —Å –Ω–∏–∑–∫–æ–π –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é (–Ω–µ–±–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π)

–ù–∞–ø—Ä–∏–º–µ—Ä:

- gender (M/F)
    
- status (active/inactive/deleted)
    
- boolean —Ñ–ª–∞–≥–∏
    
- –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    
- —Ä–µ–≥–∏–æ–Ω—ã (50 —à—Ç.)
    
- —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (mobile/desktop/tablet)
    

### ‚úî –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã OLAP

–ì–¥–µ:

- –º–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–π
    
- –º–Ω–æ–≥–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π —É—Å–ª–æ–≤–∏–π
    
- —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è AND / OR / NOT
    

### ‚úî –ö–æ–ª–æ–Ω–æ—á–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

Bitmap ‚Äî –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –∫–æ–ª–æ–Ω–æ–∫:

- **ClickHouse**
    
- **Druid**
    
- **Pinot**
    
- **Vertica**
    
- **BigQuery** (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ)
    

---

# üèé –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

Bitmap-–∏–Ω–¥–µ–∫—Å ‚Äî –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö **–±—ã—Å—Ç—Ä—ã—Ö** —Ç–∏–ø–æ–≤ –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:

- O(N/wordsize) –≤—Ä–µ–º—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    
- –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ 64/128/256 –±–∏—Ç–∞–º–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (SIMD)
    
- –æ—Ç–ª–∏—á–Ω–æ–µ —Å–∂–∞—Ç–∏–µ (RoaringBitmap, WAH, EWAH)
    

–û–Ω –º–æ–∂–µ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å **–º–∏–ª–ª–∏–æ–Ω—ã —Å—Ç—Ä–æ–∫ –∑–∞ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã**.

---

# üß± –ü—Ä–∏–º–µ—Ä: –∫–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å–ª–æ–∂–Ω—ã–µ —É—Å–ª–æ–≤–∏—è

–ó–∞–ø—Ä–æ—Å:

`WHERE gender='M' AND status='active' AND country='USA'`

–ö–∞–∂–¥–æ–µ —É—Å–ª–æ–≤–∏–µ ‚Äî —ç—Ç–æ bitmap:

`gender=M:   1 0 1 1 0 1 0 ... status=act: 1 1 0 1 1 1 0 ... country=US: 1 0 1 0 1 0 1 ...`

–û–ø–µ—Ä–∞—Ü–∏—è:

`bitmap_gender  AND   bitmap_status  AND   bitmap_country`

–í–µ—Å—å —Ñ–∏–ª—å—Ç—Ä –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤ **–æ–¥–Ω–æ –º–≥–Ω–æ–≤–µ–Ω–∏–µ**.

---

# üìå –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Bitmap-–∏–Ω–¥–µ–∫—Å–æ–≤

### ‚úî –û—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã AND/OR/NOT

### ‚úî –û—Ç–ª–∏—á–Ω–∞—è –∫–æ–º–ø—Ä–µ—Å—Å–∏—è (—Ö—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫ bitmaps)

### ‚úî –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è OLAP

### ‚úî –†–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –æ–≥—Ä–æ–º–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö

### ‚úî –õ–µ–≥–∫–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–µ—Å—è—Ç–∫–∏ —É—Å–ª–æ–≤–∏–π

---

# ‚ö† –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ Bitmap-–∏–Ω–¥–µ–∫—Å–æ–≤

### ‚ùå –ü–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞—é—Ç –¥–ª—è –∫–æ–ª–æ–Ω–æ–∫ —Å –≤—ã—Å–æ–∫–æ–π –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é

–ù–∞–ø—Ä–∏–º–µ—Ä, uuid –∏–ª–∏ email ‚Üí —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π ‚Üí —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ bitmap-–æ–≤.

### ‚ùå –ü–ª–æ—Ö–æ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è OLTP –∏ —á–∞—Å—Ç—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

Bitmap-–∏–Ω–¥–µ–∫—Å—ã –¥–æ—Ä–æ–≥–∏–µ –ø—Ä–∏ UPDATE/INSERT.

### ‚ùå –ë–æ–ª—å—à–∏–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏

–ë–∞–∑–∞ –¥–æ–ª–∂–Ω–∞ –æ–±–Ω–æ–≤–ª—è—Ç—å –±–∏—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –ø—Ä–∏ –∫–∞–∂–¥–æ–π –≤—Å—Ç–∞–≤–∫–µ.

---

# üõ† –ì–¥–µ bitmap-–∏–Ω–¥–µ–∫—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è

### ‚≠ê –í –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏ –∫–æ–ª–æ–Ω–æ—á–Ω—ã—Ö –°–£–ë–î:

- ClickHouse (bitmap —Ñ—É–Ω–∫—Ü–∏–π –∏ roaring bitmaps)
    
- Apache Druid (core data structure)
    
- Pinot
    
- Vertica
    
- Redshift
    
- BigQuery
    

### ‚≠ê –í –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –∏ BI

### ‚≠ê –í –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö (inverted index ‚Äî —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π bitmap)

---

# üéØ –ò—Ç–æ–≥

**Bitmap-–∏–Ω–¥–µ–∫—Å ‚Äî —ç—Ç–æ –∏–Ω–¥–µ–∫—Å, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ –≤–∏–¥–µ –±–∏—Ç–æ–≤—ã—Ö –º–∞—Å–æ–∫ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ –±—ã—Å—Ç—Ä–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –±–æ–ª—å—à–∏–µ –æ–±—ä—ë–º—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º.**

–û–Ω –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:  
‚úî –∫–æ–ª–æ–Ω–æ–∫ —Å –Ω–µ–±–æ–ª—å—à–∏–º –Ω–∞–±–æ—Ä–æ–º –∑–Ω–∞—á–µ–Ω–∏–π  
‚úî –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (OLAP)  
‚úî —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö  
‚úî Boolean/enum –ø–æ–ª–µ–π

–ù–æ –Ω–µ –≥–æ–¥–∏—Ç—Å—è –¥–ª—è:  
‚úò —á–∞—Å—Ç—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π  
‚úò –∫–æ–ª–æ–Ω–æ–∫ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏  
‚úò OLTP-–Ω–∞–≥—Ä—É–∑–æ–∫

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**:

**–ü—Ä–∏–º–µ—Ä**:

**–î–æ–ø. —Å—Å—ã–ª–∫–∏:** [[–ò–Ω–¥–µ–∫—Å—ã]]

**Tags**: #IT #Backend  #–ë–∞–∑–∞–î–∞–Ω–Ω—ã—Ö 