> –í PostgreSQL **–ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ (REINDEX)** –Ω—É–∂–Ω–æ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –µ–≥–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã,  
> –∫–æ–≥–¥–∞ –∏–Ω–¥–µ–∫—Å —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º **—Ä–∞–∑—Ä–∞—Å—Ç–∞–µ—Ç—Å—è, —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–∞–µ—Ç—Å—è**.
> 
> –¢–æ –µ—Å—Ç—å `REINDEX` ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± ¬´–ø–µ—Ä–µ—Å—Ç—Ä–æ–∏—Ç—å¬ª –∏–Ω–¥–µ–∫—Å –∑–∞–Ω–æ–≤–æ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã, —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å –µ–º—É –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.
> 
> –ú—ã –¥–µ–ª–∞–µ–º —ç—Ç–æ, –∫–æ–≥–¥–∞ –≤–∏–¥–∏–º:
> 
> - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∏–Ω–¥–µ–∫—Å–∞ –±–µ–∑ —Ä–æ—Å—Ç–∞ –¥–∞–Ω–Ω—ã—Ö (bloat),
>     
> - –ø–∞–¥–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–ª–∞–Ω–æ–≤ (–∏–Ω–¥–µ–∫—Å –Ω–µ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–æ–º),
>     
> - –æ—à–∏–±–∫–∏ –≤—Ä–æ–¥–µ `index corruption`,
>     
> - –∏–ª–∏ –∫–æ–≥–¥–∞ –ø–æ—Å–ª–µ –º–∞—Å—Å–æ–≤—ã—Ö `DELETE` / `UPDATE` –∏–Ω–¥–µ–∫—Å —Å—Ç–∞–ª —Ä–∞–∑–¥—É—Ç—ã–º.
>     

---

## üîπ –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º

PostgreSQL –∏–Ω–¥–µ–∫—Å ‚Äî —ç—Ç–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (—á–∞—â–µ –≤—Å–µ–≥–æ **B-tree**).  
–°–æ –≤—Ä–µ–º–µ–Ω–µ–º –∏–∑-–∑–∞ `UPDATE` –∏ `DELETE`:

- —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ —Å—Ç—Ä–æ–∫ —É–¥–∞–ª—è—é—Ç—Å—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã,
    
- **–Ω–æ –≤ –∏–Ω–¥–µ–∫—Å–µ –æ—Å—Ç–∞—é—Ç—Å—è ‚Äú–º–µ—Ä—Ç–≤—ã–µ‚Äù –∑–∞–ø–∏—Å–∏** (–¥–æ VACUUM –æ–Ω–∏ –Ω–µ –æ—á–∏—â–∞—é—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é).  
    –î–∞–∂–µ –ø–æ—Å–ª–µ VACUUM, B-tree –º–æ–∂–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è **—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º**: —Å—Ç—Ä–∞–Ω–∏—á–∫–∏ —á–∞—Å—Ç–∏—á–Ω–æ –ø—É—Å—Ç—ã–µ, –Ω–µ —É–ø–ª–æ—Ç–Ω—ë–Ω–Ω—ã–µ.
    

üß© `REINDEX` —á–∏—Ç–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –∏ **—Å—Ç—Ä–æ–∏—Ç –∏–Ω–¥–µ–∫—Å –∑–∞–Ω–æ–≤–æ** ‚Äî –±–µ–∑ –º—É—Å–æ—Ä–∞ –∏ –¥—ã—Ä.

---

## üîπ –ü—Ä–∏–º–µ—Ä

`REINDEX INDEX idx_user_email;       -- –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∏–Ω–¥–µ–∫—Å REINDEX TABLE users;                -- –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –≤—Å–µ –∏–Ω–¥–µ–∫—Å—ã —Ç–∞–±–ª–∏—Ü—ã REINDEX DATABASE mydb;              -- –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –≤—Å–µ –∏–Ω–¥–µ–∫—Å—ã –±–∞–∑—ã`

–ü–æ—Å–ª–µ `REINDEX`:

- –∏–Ω–¥–µ–∫—Å–Ω—ã–π —Ñ–∞–π–ª –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–æ–≤—ã–º,
    
- –∑–∞–Ω–∏–º–∞–µ–º–æ–µ –º–µ—Å—Ç–æ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è,
    
- –ø–ª–∞–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —ç—Ç–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ —Å–Ω–æ–≤–∞ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º–∏.
    

---

## üîπ –ö–∞–∫ —ç—Ç–æ –¥–µ–ª–∞–µ–º –≤ –¢-–ë–∞–Ω–∫–µ (–∏–ª–∏ –∫—Ä—É–ø–Ω–æ–º –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ)

> –í –ø—Ä–æ–¥–µ –º—ã –Ω–µ –º–æ–∂–µ–º –ø—Ä–æ—Å—Ç–æ ¬´—É–ø–∞—Å—Ç—å –Ω–∞ REINDEX¬ª ‚Äî —ç—Ç–æ –±–ª–æ–∫–∏—Ä—É—é—â–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è.  
> –ü–æ—ç—Ç–æ–º—É –≤ –¢-–ë–∞–Ω–∫–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º **`REINDEX CONCURRENTLY`**, —á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –Ω–∞ –∑–∞–ø–∏—Å—å.

`REINDEX INDEX CONCURRENTLY idx_user_email;`

- **CONCURRENTLY** –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç –∏–Ω–¥–µ–∫—Å –≤ —Ñ–æ–Ω–µ:
    
    1. –°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å.
        
    2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è.
        
    3. –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Å—Ç–∞—Ä—ã–π –Ω–∞ –Ω–æ–≤—ã–π.
        
- –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–∏ —ç—Ç–æ–º –æ—Å—Ç–∞—ë—Ç—Å—è **–¥–æ—Å—Ç—É–ø–Ω–æ–π –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏**.
    
- –ú–∏–Ω—É—Å ‚Äî —á—É—Ç—å –¥–æ–ª—å—à–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –º–µ—Å—Ç–∞.
    

---

## üîπ –ö–∞–∫ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –∏–Ω–¥–µ–∫—Å –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å

1. **–°–∏–ª—å–Ω–æ –≤—ã—Ä–æ—Å —Ä–∞–∑–º–µ—Ä:**
    
    `SELECT relname AS index_name,        pg_size_pretty(pg_relation_size(indexrelid)) AS index_size FROM pg_stat_user_indexes WHERE relname = 'idx_user_email';`
    
    –ï—Å–ª–∏ –∏–Ω–¥–µ–∫—Å –∑–∞–Ω–∏–º–∞–µ—Ç –≤ 2‚Äì3 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ, —á–µ–º —Ç–∞–±–ª–∏—Ü–∞ ‚Äî —è–≤–Ω–æ bloated.
    
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ bloating (—á–µ—Ä–µ–∑ pgstattuple / pg_bloat_estimate):**
    
    `SELECT * FROM pgstattuple('idx_user_email');`
    
    –ï—Å–ª–∏ `approximate bloat > 30%` ‚Äî –ø–æ—Ä–∞ –¥–µ–ª–∞—Ç—å REINDEX.
    
3. **–ü–∞–¥–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–ª–∞–Ω–∞ (–∏–Ω–¥–µ–∫—Å –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è):**
    
    - –°–º–æ—Ç—Ä–∏–º `EXPLAIN ANALYZE` ‚Äî –µ—Å–ª–∏ —Ä–∞–Ω—å—à–µ –±—ã–ª `Index Scan`, –∞ —Ç–µ–ø–µ—Ä—å `Seq Scan`,  
        –≤–æ–∑–º–æ–∂–Ω–æ, –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä —Å—á–∏—Ç–∞–µ—Ç –∏–Ω–¥–µ–∫—Å –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –∏–∑-–∑–∞ bloating.
        

---

## üîπ –¢–∏–ø–∏—á–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ (–∏–∑ –æ–ø—ã—Ç–∞ –¢-–ë–∞–Ω–∫–∞)

1. **–¢–∞–±–ª–∏—Ü—ã –ª–æ–≥–æ–≤ / –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–±—ã—Ç–∏–π**
    
    - –ß–∞—Å—Ç—ã–µ `INSERT` –∏ `DELETE` ‚Üí –∏–Ω–¥–µ–∫—Å –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–¥—É–≤–∞–µ—Ç—Å—è.
        
    - –£ –Ω–∞—Å –Ω–∞ —Ç–∞–∫–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö –ø–æ –Ω–æ—á–∞–º cron –¥–µ–ª–∞–µ—Ç `REINDEX CONCURRENTLY` –¥–ª—è "–≥–æ—Ä—è—á–∏—Ö" –∏–Ω–¥–µ–∫—Å–æ–≤.
        
2. **–§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ—Å–ª–µ VACUUM FULL**
    
    - –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ —á–∏—Å—Ç–∏—Ç—Å—è `VACUUM FULL`, –Ω–æ –∏–Ω–¥–µ–∫—Å –æ—Å—Ç–∞—ë—Ç—Å—è —Å—Ç–∞—Ä—ã–º, –¥–µ–ª–∞–µ–º `REINDEX`.
        
3. **–ú–∞—Å—Å–æ–≤—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–æ–≤ / —Å—Ç–∞—Ç—É—Å–æ–≤**
    
    - –ü—Ä–∏ –º–∞—Å—Å–æ–≤–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ `status`-–ø–æ–ª–µ–π (—á–∞—Å—Ç–æ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö) –∏–Ω–¥–µ–∫—Å –º–æ–∂–µ—Ç —Ä–∞–∑–¥—É—Ç—å—Å—è.
        
    - –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –±–∞—Ç—á–∞ –ø–ª–∞–Ω–∏—Ä—É–µ–º `REINDEX CONCURRENTLY`.
        
4. **–ö–æ—Ä—Ä—É–ø—Ü–∏—è –ø–æ—Å–ª–µ —Å–±–æ—è –∏–ª–∏ –±–∞–≥–∞**
    
    - –†–µ–¥–∫–æ, –Ω–æ –±—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ –ø–∞–¥–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞/–¥–∏—Å–∫–∞ ‚Äî —Ç–æ–≥–¥–∞ `REINDEX` –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É.
        

---

## üîπ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ –ø—Ä–∞–∫—Ç–∏–∫–∞

> –í –¢-–ë–∞–Ω–∫–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–Ω–¥–µ–∫—Å–æ–≤ (—á–µ—Ä–µ–∑ `pgstattuple` –∏ `pg_stat_all_indexes`),  
> –∫–æ—Ç–æ—Ä—ã–π –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç:
> 
> - —Ä–∞–∑–º–µ—Ä –∏–Ω–¥–µ–∫—Å–∞,
>     
> - —É—Ä–æ–≤–µ–Ω—å bloating,
>     
> - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–º (`idx_scan` / `seq_scan` ratio).
>     
> 
> –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, > 50% bloating) ‚Äî –≤–∫–ª—é—á–∞–µ—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π `REINDEX CONCURRENTLY` –≤ –Ω–æ—á–Ω–æ–º maintenance window**.

---

## üîπ –í–∞–∂–Ω–æ: –æ—Ç–ª–∏—á–∏–µ –æ—Ç VACUUM / ANALYZE

|–ö–æ–º–∞–Ω–¥–∞|–ß—Ç–æ –¥–µ–ª–∞–µ—Ç|
|---|---|
|`VACUUM`|–£–¥–∞–ª—è–µ—Ç –º—ë—Ä—Ç–≤—ã–µ —Å—Ç—Ä–æ–∫–∏, –Ω–æ –Ω–µ –¥–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä—É–µ—Ç –∏–Ω–¥–µ–∫—Å|
|`ANALYZE`|–û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞|
|`REINDEX`|–ü–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–∞–º –∏–Ω–¥–µ–∫—Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏|
|`REINDEX CONCURRENTLY`|–¢–æ –∂–µ, –Ω–æ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏|

---

## üí¨ –ö–∞–∫ –º–æ–∂–Ω–æ –∑–∞–∫–æ–Ω—á–∏—Ç—å –æ—Ç–≤–µ—Ç –∫—Ä–∞—Å–∏–≤–æ

> –í —Ü–µ–ª–æ–º, `REINDEX` ‚Äî —ç—Ç–æ ‚Äú–ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞‚Äù –∏–Ω–¥–µ–∫—Å–∞, –∫–æ—Ç–æ—Ä–∞—è –Ω—É–∂–Ω–∞,  
> –∫–æ–≥–¥–∞ –æ–Ω –ø–µ—Ä–µ—Å—Ç–∞—ë—Ç –±—ã—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –∏–∑-–∑–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–ª–∏ bloating.
> 
> –í –¢-–ë–∞–Ω–∫–µ –º—ã —Ä–µ–≥—É–ª—è—Ä–Ω–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –∏ –¥–µ–ª–∞–µ–º **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π `REINDEX CONCURRENTLY`**  
> –¥–ª—è —Ç–∞–±–ª–∏—Ü —Å –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ –ø–ª–∞–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤.