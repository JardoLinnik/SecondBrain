> –í PostgreSQL –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ –∏–Ω–¥–µ–∫—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ ‚Äî  
> **Index Scan**, **Bitmap Index Scan** –∏ **Bitmap Heap Scan**.
> 
> üîπ **–û–±—ã—á–Ω–æ–µ –∏–Ω–¥–µ–∫—Å–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (Index Scan)** ‚Äî —á–∏—Ç–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏ **–≤ –ø–æ—Ä—è–¥–∫–µ –∏–Ω–¥–µ–∫—Å–∞**,  
> –∏–∑–≤–ª–µ–∫–∞—è –∏—Ö –æ–¥–Ω—É –∑–∞ –¥—Ä—É–≥–æ–π, –∏ —Å—Ä–∞–∑—É –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ —Ç–∞–±–ª–∏—Ü–µ –∑–∞ –∫–∞–∂–¥—ã–º –Ω–∞–π–¥–µ–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.
> 
> üîπ **Bitmap Index Scan** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —Ñ–∏–ª—å—Ç—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–º–Ω–æ–≥–æ —Å—Ç—Ä–æ–∫**,  
> –∏ —Ö–æ–¥–∏—Ç—å –≤ —Ç–∞–±–ª–∏—Ü—É –∑–∞ –∫–∞–∂–¥–æ–π –∏–∑ –Ω–∏—Ö –¥–æ—Ä–æ–≥–æ.
> 
> –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ PostgreSQL —Å–Ω–∞—á–∞–ª–∞ **—Å—Ç—Ä–æ–∏—Ç –±–∏—Ç–æ–≤—É—é –∫–∞—Ä—Ç—É (bitmap)** ‚Äî  
> —Ç–æ –µ—Å—Ç—å —Å–ø–∏—Å–æ–∫ –Ω–æ–º–µ—Ä–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü —Ç–∞–±–ª–∏—Ü—ã, –≥–¥–µ –µ—Å—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–µ —Å—Ç—Ä–æ–∫–∏,  
> –∞ –ø–æ—Ç–æ–º –∏–¥—ë—Ç –≤ —Ç–∞–±–ª–∏—Ü—É **–ø–æ —ç—Ç–æ–π –∫–∞—Ä—Ç–µ** ‚Äî **Bitmap Heap Scan**.
> 
> –≠—Ç–æ –±—ã—Å—Ç—Ä–µ–µ, –∫–æ–≥–¥–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –º–Ω–æ–≥–æ,  
> –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª—É—á–∞–π–Ω—ã—Ö —á—Ç–µ–Ω–∏–π —Å –¥–∏—Å–∫–∞ (random I/O).
> 
> –í –¢-–ë–∞–Ω–∫–µ –º—ã —á–∞—Å—Ç–æ –≤–∏–¥–∏–º bitmap-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö,  
> –≥–¥–µ –≤ —Ñ–∏–ª—å—Ç—Ä–µ —É—á–∞—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω–¥–µ–∫—Å–æ–≤ –∏–ª–∏ —É—Å–ª–æ–≤–∏–µ —Ç–∏–ø–∞ `status IN (...) AND date BETWEEN ...`.

---

## üîç –ß—Ç–æ —Ç–∞–∫–æ–µ Index Scan

**Index Scan** ‚Äî PostgreSQL –∏–¥—ë—Ç –ø–æ –∏–Ω–¥–µ–∫—Å—É, –∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏:

1. –ù–∞—Ö–æ–¥–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∏–Ω–¥–µ–∫—Å–µ;
    
2. –ò–¥—ë—Ç –≤ heap (—Ç–∞–±–ª–∏—Ü—É) –ø–æ `TID` (tuple id);
    
3. –°—á–∏—Ç—ã–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫—É;
    
4. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏–µ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
    

üîß –ü—Ä–∏–º–µ—Ä:

`EXPLAIN ANALYZE SELECT * FROM users WHERE email = 'user@example.com';`

`Index Scan using idx_users_email on users  (cost=0.42..8.44 rows=1 width=72)`

‚û°Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ **–æ–∂–∏–¥–∞–µ—Ç—Å—è –º–∞–ª–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π (—Å–µ–ª–µ–∫—Ç–∏–≤–Ω—ã–π –∏–Ω–¥–µ–∫—Å)**.  
‚û°Ô∏è –ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è `WHERE id = ...` –∏–ª–∏ `email = ...`.

---

## üîç –ß—Ç–æ —Ç–∞–∫–æ–µ Bitmap Index Scan / Bitmap Heap Scan

–ö–æ–≥–¥–∞ –∑–∞–ø—Ä–æ—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–º–Ω–æ–≥–æ —Å—Ç—Ä–æ–∫**, –ø—Ä—è–º–æ–µ Index Scan —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º,  
–ø–æ—Ç–æ–º—É —á—Ç–æ PostgreSQL –¥–µ–ª–∞–µ—Ç –∫—É—á—É **random access** –≤ heap (—á—Ç–µ–Ω–∏–µ –ø–æ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ).

üîπ **Bitmap Index Scan** –¥–µ–ª–∞–µ—Ç –¥–≤–∞ —à–∞–≥–∞:

1. –ß–∏—Ç–∞–µ—Ç –∏–Ω–¥–µ–∫—Å –∏ —Å–æ–∑–¥–∞—ë—Ç **bitmap** ‚Äî –º–∞—Å—Å–∏–≤ –±–∏—Ç–æ–≤, –≥–¥–µ 1 = –Ω—É–∂–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞;
    
2. **Bitmap Heap Scan** —á–∏—Ç–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É **—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π**, –Ω–µ –ø–æ —Å—Ç—Ä–æ–∫–∞–º.
    

üîß –ü—Ä–∏–º–µ—Ä:

`EXPLAIN ANALYZE SELECT * FROM users WHERE country = 'RU' AND status = 'active';`

`Bitmap Heap Scan on users  (cost=45.00..1200.00 rows=10000 width=72)   Recheck Cond: ((country = 'RU') AND (status = 'active'))   ->  BitmapAnd         ->  Bitmap Index Scan on idx_users_country               Index Cond: (country = 'RU')         ->  Bitmap Index Scan on idx_users_status               Index Cond: (status = 'active')`

‚û°Ô∏è PostgreSQL **–æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ bitmap-–æ–≤** —á–µ—Ä–µ–∑ `BitmapAnd` –∏–ª–∏ `BitmapOr`,  
–∏ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –∏–¥—ë—Ç –≤ heap.  
–≠—Ç–æ **–≤ –¥–µ—Å—è—Ç–∫–∏ —Ä–∞–∑ —Å–Ω–∏–∂–∞–µ—Ç random I/O**, –µ—Å–ª–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Å—Ç—Ä–æ–∫ –º–Ω–æ–≥–æ.

---

## üîπ –ö–æ–≥–¥–∞ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

|–°—Ü–µ–Ω–∞—Ä–∏–π|–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è|–ü–æ—á–µ–º—É|
|---|---|---|
|`WHERE id = 123`|**Index Scan**|–í—ã—Å–æ–∫–∞—è —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (1 –∑–∞–ø–∏—Å—å)|
|`WHERE email = 'x@y.com'`|**Index Scan**|–ò–Ω–¥–µ–∫—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞–ª–æ —Å—Ç—Ä–æ–∫|
|`WHERE country = 'RU' AND status = 'active'`|**Bitmap Index Scan + Bitmap Heap Scan**|–ù–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω–¥–µ–∫—Å–æ–≤, –º–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π|
|`WHERE created_at BETWEEN ...` (–¥–µ—Å—è—Ç–∫–∏ —Ç—ã—Å. —Å—Ç—Ä–æ–∫)|**Bitmap Heap Scan**|–ú–Ω–æ–≥–æ –ø–æ–ø–∞–¥–∞–Ω–∏–π, –≤—ã–≥–æ–¥–Ω–µ–µ —Å–æ–±—Ä–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã|
|`SELECT COUNT(*) ...` –ø–æ –∏–Ω–¥–µ–∫—Å—É|**Bitmap Index Scan**|PostgreSQL –º–æ–∂–µ—Ç —Å—á–∏—Ç–∞—Ç—å —á–µ—Ä–µ–∑ bitmap –±–µ–∑ heap|
|–¢–∞–±–ª–∏—Ü–∞ –º–∞–ª–µ–Ω—å–∫–∞—è, —Ñ–∏–ª—å—Ç—Ä —Å–ª–∞–±—ã–π|**Seq Scan**|–ò–Ω–¥–µ–∫—Å –Ω–µ–≤—ã–≥–æ–¥–µ–Ω –≤–æ–æ–±—â–µ|

---

## üîπ –ö–∞–∫ PostgreSQL –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–∏–ø —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (`planner`) –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç:

- **–°–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É—Å–ª–æ–≤–∏—è** (—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è);
    
- **–†–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã –∏ –∏–Ω–¥–µ–∫—Å–∞**;
    
- **–°—Ç–æ–∏–º–æ—Å—Ç—å —Å–ª—É—á–∞–π–Ω–æ–≥–æ I/O** (`random_page_cost`);
    
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω–¥–µ–∫—Å–æ–≤ (`BitmapAnd` / `BitmapOr`).
    

–ï—Å–ª–∏ –æ–∂–∏–¥–∞–µ—Ç—Å—è:

- **–º–∞–ª–æ —Å—Ç—Ä–æ–∫** ‚Üí `Index Scan`;
    
- **–º–Ω–æ–≥–æ —Å—Ç—Ä–æ–∫, –Ω–æ –Ω–µ –≤—Å–µ** ‚Üí `Bitmap Index + Bitmap Heap Scan`;
    
- **–ø–æ—á—Ç–∏ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏** ‚Üí `Seq Scan`.
    

---

## üîπ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

`Index Scan:   –∏–Ω–¥–µ–∫—Å -> heap -> –∏–Ω–¥–µ–∫—Å -> heap -> –∏–Ω–¥–µ–∫—Å -> heap  Bitmap Scan:   –∏–Ω–¥–µ–∫—Å -> –∏–Ω–¥–µ–∫—Å -> –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å -> bitmap   bitmap -> heap (–ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ, –Ω–µ –ø–æ —Å—Ç—Ä–æ–∫–∞–º)`

---

## üîπ –ü—Ä–∏–º–µ—Ä –∏–∑ –¢-–ë–∞–Ω–∫–∞

> –í –¢-–ë–∞–Ω–∫–µ bitmap-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–∞ –æ—Ç—á—ë—Ç–Ω—ã—Ö –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö:
> 
> –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –∑–∞–ø—Ä–æ—Å–µ –ø–æ —Ç–∞–±–ª–∏—Ü–µ `transactions`,  
> –≥–¥–µ —Ñ–∏–ª—å—Ç—Ä `status IN ('completed', 'declined') AND operation_date BETWEEN now() - interval '7 days' AND now()`.
> 
> –£ –Ω–∞—Å –µ—Å—Ç—å –¥–≤–∞ –∏–Ω–¥–µ–∫—Å–∞ ‚Äî –ø–æ `status` –∏ –ø–æ `operation_date`.  
> –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Å—Ç—Ä–æ–∏—Ç **Bitmap Index Scan –ø–æ –æ–±–æ–∏–º**,  
> –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏—Ö (`BitmapAnd`) –∏ –ø–æ—Ç–æ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç **Bitmap Heap Scan**.
> 
> –≠—Ç–æ –¥–∞—ë—Ç –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ x5‚Äìx10 –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å `Seq Scan`,  
> –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ —Ç–∞–±–ª–∏—Ü–∞—Ö –≤ –¥–µ—Å—è—Ç–∫–∏ –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Å—Ç—Ä–æ–∫.

üß∞ **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**  
`EXPLAIN ANALYZE`, `pg_stat_statements`, `pg_statio_user_tables`, `random_page_cost`, `work_mem`.

---

## üí¨ –ö–∞–∫ –∫—Ä–∞—Å–∏–≤–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å –æ—Ç–≤–µ—Ç

> –í —Ü–µ–ª–æ–º, **Index Scan** ‚Äî —ç—Ç–æ ‚Äú—Ç–æ—á–µ—á–Ω–æ–µ‚Äù —á—Ç–µ–Ω–∏–µ, –∫–æ–≥–¥–∞ –∑–∞–ø–∏—Å–µ–π –º–∞–ª–æ,  
> –∞ **Bitmap Scan** ‚Äî ‚Äú–º–∞—Å—Å–æ–≤–æ–µ‚Äù, –∫–æ–≥–¥–∞ –∑–∞–ø–∏—Å–µ–π –º–Ω–æ–≥–æ,  
> –∏ PostgreSQL —É–º–Ω–æ –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –∏—Ö –≤ bitmap, —á—Ç–æ–±—ã –Ω–µ –ø—Ä—ã–≥–∞—Ç—å –ø–æ –¥–∏—Å–∫—É.
> 
> –í –¢-–ë–∞–Ω–∫–µ –º—ã –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º bitmap-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –æ—Ç—á—ë—Ç–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö,  
> –≥–¥–µ —á–∞—Å—Ç–æ –∏–¥—É—Ç —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∏–Ω–¥–µ–∫—Å–∞–º ‚Äî  
> –æ–Ω–æ –¥–∞—ë—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–µ–∑ –ª–∏—à–Ω–µ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ I/O.