> –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —è —Å–º–æ—Ç—Ä—é –ª–æ–≥–∏ —á–µ—Ä–µ–∑ **—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** ‚Äî  
> —É –Ω–∞—Å –≤ –¢-–ë–∞–Ω–∫–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Grafana + Loki**, –∞ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö ‚Äî **ELK (Elasticsearch, Logstash, Kibana)**.
> 
> –í—Å–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –ø–∏—à—É—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ **JSON-–ª–æ–≥–∏ –≤ stdout**, Kubernetes —á–µ—Ä–µ–∑ **Fluent Bit** —Å–æ–±–∏—Ä–∞–µ—Ç –∏—Ö –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ Loki.
> 
> –í Grafana –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π –ª–æ–≥ –ø–æ `service`, `trace_id`, `user_id`, `request_id` –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—É –ø–æ —É—Ä–æ–≤–Ω—é `ERROR`.
> 
> –û—à–∏–±–∫–∏ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è —è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é —á–µ—Ä–µ–∑ **Sentry** ‚Äî —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å stacktrace –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞.

---

## üîπ –ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω –ø–∞–π–ø–ª–∞–π–Ω –ª–æ–≥–æ–≤ (—Ä–µ–∞–ª—å–Ω–æ, –∫–∞–∫ –≤ –¢-–ë–∞–Ω–∫–µ)

```
[–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (FastAPI, Kafka Consumer)]
      ‚Üì  (stdout, JSON-–ª–æ–≥)
[Fluent Bit DaemonSet –≤ Kubernetes]
      ‚Üì
[–ü–æ—Ç–æ–∫ –ª–æ–≥–æ–≤ ‚Üí Loki (–∏–ª–∏ Elasticsearch)]
      ‚Üì
[Grafana / Kibana / Alertmanager / Sentry]

```

> –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —è –Ω–µ –ª–µ–∑—É –Ω–∞ –Ω–æ–¥—ã —Ä—É–∫–∞–º–∏ ‚Äî –≤—Å—ë –¥–æ—Å—Ç—É–ø–Ω–æ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ, —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏ –∏—Å—Ç–æ—Ä–∏–µ–π.

---

## üîπ –ì–¥–µ –∏ –∫–∞–∫ —Ç—ã —Å–º–æ—Ç—Ä–∏—à—å –ª–æ–≥–∏

|–°—Ä–µ–¥–∞|–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç|–ß—Ç–æ –¥–µ–ª–∞—é|
|---|---|---|
|üß± **Dev / Stage**|`kubectl logs <pod>`|–õ–æ–∫–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞, trace-id –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É Pod|
|‚òÅÔ∏è **Prod**|**Grafana Loki**|–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ ‚Äî –ø–æ–∏—Å–∫, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –∫–æ—Ä–µ–ª—è—Ü–∏—è –ø–æ trace_id|
|‚öôÔ∏è **CI/CD**|**GitLab CI ‚Üí Job logs**|–ü—Ä–æ–≤–µ—Ä—è—é –ø–∞–π–ø–ª–∞–π–Ω, –æ—à–∏–±–∫–∏ –Ω–∞ —ç—Ç–∞–ø–µ –¥–µ–ø–ª–æ—è|
|üö® **–û—à–∏–±–∫–∏ / –∏—Å–∫–ª—é—á–µ–Ω–∏—è**|**Sentry**|Stacktrace, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –≤–µ—Ä—Å–∏—è, –∫–æ–Ω—Ç–µ–∫—Å—Ç|
|üìä **–ú–µ—Ç—Ä–∏–∫–∏ + –ª–æ–≥–∏ –≤–º–µ—Å—Ç–µ**|**Grafana dashboards**|–û—à–∏–±–∫–∏, latency, 5xx, consumer lag –∏ –ª–æ–≥–∏ —Ä—è–¥–æ–º|

---

## üîπ –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –≤ Grafana Loki

`{service="payments-api", level="ERROR"} |= "card_declined" | trace_id="9af..."`

–∏–ª–∏

`{namespace="prod", app="antifraud-service"} |= "TimeoutError"`

> –¢–∞–∫ —è –Ω–∞—Ö–æ–∂—É –≤—Å–µ –æ—à–∏–±–∫–∏ –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–ª–∏ –ø–ª–∞—Ç–µ–∂—É, –ª–∏–±–æ –≤–∏–∂—É –≤–µ—Å—å ‚Äú–ø—É—Ç—å‚Äù –∑–∞–ø—Ä–æ—Å–∞ –ø–æ trace_id —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤.

---

## üîπ –ö–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ

- –í Grafana —É –Ω–∞—Å –¥–∞—à–±–æ—Ä–¥ ‚Äú**–°–µ—Ä–≤–∏—Å ‚Üí Logs + Traces**‚Äù  
    –º–æ–∂–Ω–æ –Ω–∞–∂–∞—Ç—å –Ω–∞ trace_id ‚Üí —Å—Ä–∞–∑—É –ø–µ—Ä–µ–π—Ç–∏ –≤ Jaeger ‚Üí –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –≥–¥–µ –∑–∞–¥–µ—Ä–∂–∫–∞.
    
- –û—à–∏–±–∫–∏ —É—Ä–æ–≤–Ω—è `ERROR` –∏ `CRITICAL` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Ö–æ–¥—è—Ç –≤ **Sentry**,  
    –≥–¥–µ –≤–∏–¥–µ–Ω stacktrace, user, release –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ.
    
- –î–ª—è –±—ã—Å—Ç—Ä–æ–π –æ—Ç–ª–∞–¥–∫–∏ –Ω–∞ dev –æ–∫—Ä—É–∂–µ–Ω–∏–∏ ‚Äî `kubectl logs pod-name -f`.
    

---

## üîπ –ü—Ä–∏–º–µ—Ä –∏–∑ —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

> –í –º–æ—ë–º —Å–µ—Ä–≤–∏—Å–µ –Ω–∞ FastAPI –ª–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –≤ JSON —Å trace_id, request_id –∏ user_id.  
> –í Loki —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—Å—é —Ü–µ–ø–æ—á–∫—É –∑–∞–ø—Ä–æ—Å–∞ ‚Äî  
> –Ω–∞–ø—Ä–∏–º–µ—Ä, ‚Äú–∫–ª–∏–µ–Ω—Ç –æ—Ç–∫—Ä—ã–ª —Å–µ—Å—Å–∏—é ‚Üí –∑–∞–ø—Ä–æ—Å —É—à—ë–ª –≤ antifraud ‚Üí –≤–µ—Ä–Ω—É–ª—Å—è —Å –æ—à–∏–±–∫–æ–π‚Äù.
> 
> –ü–ª—é—Å —É –Ω–∞—Å –¥–∞—à–±–æ—Ä–¥—ã –≤ Grafana –æ–±—ä–µ–¥–∏–Ω—è—é—Ç –º–µ—Ç—Ä–∏–∫–∏ –∏ –ª–æ–≥–∏ ‚Äî –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —Ä–æ—Å—Ç latency –∏ —Å—Ä–∞–∑—É –ø—Ä–æ–≤–∞–ª–∏—Ç—å—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ª–æ–≥–∏.

---

## üí¨ –ö–∞–∫ –º–æ–∂–Ω–æ –∫—Ä–∞—Å–∏–≤–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å –æ—Ç–≤–µ—Ç

> –¢–æ –µ—Å—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —è –Ω–µ ‚Äú—Å–º–æ—Ç—Ä—é tail‚Äù,  
> –∞ —Ä–∞–±–æ—Ç–∞—é —á–µ—Ä–µ–∑ **—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–µ–∫ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç–∏** ‚Äî Grafana, Loki, Sentry.
> 
> –≠—Ç–æ –¥–∞—ë—Ç –ø–æ–ª–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É –ø–æ —Å–µ—Ä–≤–∏—Å—É: –º–µ—Ç—Ä–∏–∫–∏, —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏ –∏ –ª–æ–≥–∏ ‚Äî –≤—Å—ë –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ,  
> –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–±–∏—Ä–∞—Ç—å –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã –∏ –¥–µ–ª–∞—Ç—å root cause analysis.